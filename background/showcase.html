<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All 88 Constellations</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600&family=Parisienne&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0a0e1a;
            min-height: 100vh;
            padding: 20px;
        }

        h1 {
            text-align: center;
            color: #d4af37;
            font-family: 'Cinzel', serif;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
        }

        .subtitle {
            text-align: center;
            color: #888;
            margin-bottom: 30px;
            font-size: 1.1rem;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            max-width: 1800px;
            margin: 0 auto;
        }

        .constellation-card {
            background: rgba(20, 25, 40, 0.8);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 10px;
            padding: 10px;
            text-align: center;
            transition: all 0.3s;
        }

        .constellation-card:hover {
            border-color: rgba(212, 175, 55, 0.6);
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.2);
            transform: scale(1.02);
        }

        .constellation-card canvas {
            width: 100%;
            height: 150px;
            border-radius: 5px;
        }

        .constellation-name {
            color: #d4af37;
            font-family: 'Cinzel', serif;
            font-size: 0.9rem;
            margin-top: 8px;
            letter-spacing: 2px;
        }

        .constellation-meaning {
            color: #888;
            font-family: 'Parisienne', cursive;
            font-size: 1rem;
            margin-top: 2px;
        }
    </style>
</head>
<body>
    <h1>THE 88 CONSTELLATIONS</h1>
    <p class="subtitle">All officially recognized IAU constellations</p>
    <p class="subtitle" style="font-size: 0.9rem; margin-top: 10px;">Constellation silhouette artwork by Johan Meuris | <a href="https://artlibre.org/licence/lal/en/" target="_blank" style="color: #d4af37;">Free Art License</a></p>
    <div class="grid" id="grid"></div>

    <script type="module">
        import { CONSTELLATIONS } from './constellationData.js';

        // Draw a 4-pointed star shape
        function drawStar4Point(ctx, x, y, outerRadius, innerRadius) {
            const points = 4;
            const step = Math.PI / points;
            ctx.beginPath();
            for (let i = 0; i < points * 2; i++) {
                const radius = i % 2 === 0 ? outerRadius : innerRadius;
                const angle = i * step - Math.PI / 2;
                const px = x + Math.cos(angle) * radius;
                const py = y + Math.sin(angle) * radius;
                if (i === 0) ctx.moveTo(px, py);
                else ctx.lineTo(px, py);
            }
            ctx.closePath();
        }

        // Draw a 6-pointed star shape
        function drawStar6Point(ctx, x, y, outerRadius, innerRadius) {
            const points = 6;
            const step = Math.PI / points;
            ctx.beginPath();
            for (let i = 0; i < points * 2; i++) {
                const radius = i % 2 === 0 ? outerRadius : innerRadius;
                const angle = i * step - Math.PI / 2;
                const px = x + Math.cos(angle) * radius;
                const py = y + Math.sin(angle) * radius;
                if (i === 0) ctx.moveTo(px, py);
                else ctx.lineTo(px, py);
            }
            ctx.closePath();
        }

        function drawConstellation(canvas, data) {
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;

            // Clear
            ctx.fillStyle = '#0a0e1a';
            ctx.fillRect(0, 0, width, height);

            // Calculate bounds
            const xs = data.stars.map(s => s[0]);
            const ys = data.stars.map(s => s[1]);
            const minX = Math.min(...xs);
            const maxX = Math.max(...xs);
            const minY = Math.min(...ys);
            const maxY = Math.max(...ys);

            const dataWidth = maxX - minX || 1;
            const dataHeight = maxY - minY || 1;

            // Scale to fit with padding
            const padding = 30;
            const scaleX = (width - padding * 2) / dataWidth;
            const scaleY = (height - padding * 2) / dataHeight;
            const scale = Math.min(scaleX, scaleY, 2);

            // Center offset
            const offsetX = (width - dataWidth * scale) / 2 - minX * scale;
            const offsetY = (height - dataHeight * scale) / 2 - minY * scale;

            // Transform stars
            const stars = data.stars.map((s, i) => ({
                x: s[0] * scale + offsetX,
                y: s[1] * scale + offsetY,
                brightness: 1.5 + Math.random()
            }));

            // Draw connections
            ctx.strokeStyle = 'rgba(212, 175, 55, 0.5)';
            ctx.lineWidth = 1.5;
            ctx.shadowBlur = 5;
            ctx.shadowColor = 'rgba(212, 175, 55, 0.3)';

            data.connections.forEach(([start, end]) => {
                ctx.beginPath();
                ctx.moveTo(stars[start].x, stars[start].y);
                ctx.lineTo(stars[end].x, stars[end].y);
                ctx.stroke();
            });

            // Draw figure silhouette (if available)
            if (data.figure && data.figure.paths) {
                ctx.lineCap = 'round';
                ctx.lineJoin = 'round';

                // First pass: draw subtle fill for closed paths
                data.figure.paths.forEach(path => {
                    if (path.length < 3) return;
                    const first = path[0];
                    const last = path[path.length - 1];
                    const isClosed = Math.abs(first[0] - last[0]) < 5 && Math.abs(first[1] - last[1]) < 5;

                    if (isClosed) {
                        ctx.globalAlpha = 0.06;
                        ctx.fillStyle = 'rgba(150, 180, 210, 0.6)';
                        ctx.beginPath();
                        ctx.moveTo(path[0][0] * scale + offsetX, path[0][1] * scale + offsetY);
                        for (let i = 1; i < path.length; i++) {
                            ctx.lineTo(path[i][0] * scale + offsetX, path[i][1] * scale + offsetY);
                        }
                        ctx.closePath();
                        ctx.fill();
                    }
                });

                // Second pass: draw strokes with smooth curves
                ctx.globalAlpha = 0.2;
                ctx.strokeStyle = 'rgba(150, 180, 210, 0.7)';
                ctx.lineWidth = 1.0;

                data.figure.paths.forEach(path => {
                    if (path.length < 2) return;
                    ctx.beginPath();
                    const startX = path[0][0] * scale + offsetX;
                    const startY = path[0][1] * scale + offsetY;
                    ctx.moveTo(startX, startY);

                    if (path.length >= 3) {
                        for (let i = 1; i < path.length - 1; i++) {
                            const x = path[i][0] * scale + offsetX;
                            const y = path[i][1] * scale + offsetY;
                            const nextX = path[i + 1][0] * scale + offsetX;
                            const nextY = path[i + 1][1] * scale + offsetY;
                            const midX = (x + nextX) / 2;
                            const midY = (y + nextY) / 2;
                            ctx.quadraticCurveTo(x, y, midX, midY);
                        }
                        const lastX = path[path.length - 1][0] * scale + offsetX;
                        const lastY = path[path.length - 1][1] * scale + offsetY;
                        ctx.lineTo(lastX, lastY);
                    } else {
                        ctx.lineTo(path[1][0] * scale + offsetX, path[1][1] * scale + offsetY);
                    }
                    ctx.stroke();
                });
                ctx.globalAlpha = 1.0;
            }

            // Draw stars
            stars.forEach((star, i) => {
                const size = 3;
                const outerRadius = size * 1.8;
                const innerRadius = size * 0.4;

                ctx.shadowBlur = 8;
                ctx.shadowColor = '#ffffff';
                ctx.fillStyle = '#ffffff';

                // First star is usually brightest
                if (i === 0) {
                    drawStar6Point(ctx, star.x, star.y, outerRadius * 1.3, innerRadius);
                } else {
                    drawStar4Point(ctx, star.x, star.y, outerRadius, innerRadius);
                }
                ctx.fill();

                // Center dot
                ctx.beginPath();
                ctx.arc(star.x, star.y, innerRadius * 0.5, 0, Math.PI * 2);
                ctx.fill();
            });

            ctx.shadowBlur = 0;
        }

        // Create grid
        const grid = document.getElementById('grid');
        const keys = Object.keys(CONSTELLATIONS).sort((a, b) =>
            CONSTELLATIONS[a].name.localeCompare(CONSTELLATIONS[b].name)
        );

        keys.forEach(key => {
            const data = CONSTELLATIONS[key];

            const card = document.createElement('div');
            card.className = 'constellation-card';

            const canvas = document.createElement('canvas');
            canvas.width = 300;
            canvas.height = 200;

            const name = document.createElement('div');
            name.className = 'constellation-name';
            name.textContent = data.name.toUpperCase();

            const meaning = document.createElement('div');
            meaning.className = 'constellation-meaning';
            meaning.textContent = data.meaning || data.description || '';

            card.appendChild(canvas);
            card.appendChild(name);
            card.appendChild(meaning);
            grid.appendChild(card);

            drawConstellation(canvas, data);
        });

        console.log(`Loaded ${keys.length} constellations`);
    </script>
</body>
</html>
